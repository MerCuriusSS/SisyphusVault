---
tags:
  - Areas/开发/javaWeb
  - Areas/开发/基础原理
category: 基础原理
status: 加工
project: 后台管理系统「Ruoyi-Vue-Plus」
application: 通用规则、基础业务控制
source:
---
>[!question] 基本概念：
> 🟡 **身份**：是**servlet**组件；
> 
> 🟡 **范围**：规则控制范围是「**URL**」级别；
> 
> 🟡 **应用场景**：“通用规则”（跨域、解密、XSS）


>[!important] 控制权演变——「传统web应用」 VS 「Springboot应用」
>🔴 **servlet**是web应用**底座**——准备web运行的一切基础组件，包括过滤器，**spring**容器是用户创建实例的**代工厂**——准备一切非web组件的业务Bean（Service）。**springMVC**则是spring容器内**专精**处理**Web** 相关的Bean（Controller）
>
>🔴 **传统应用**中启动顺序是**servlet->spring容器**，因此spring容器**无法**干涉过滤器，filter由servlet创建。
>
>🔴 **springboot应用**中启动顺序是**spring容器->servlet**，spring容器控制范围增大，允许将filter**硬塞**到servlet中，能与spring容器的其他ServiceBean**协同**工作，更好完成“通用业务”建设。


>[!example] 基本原理
>1）管理：
>2）运行：
>3）执行顺序
>


>[!success] 🔴应用场景：
>1.XSS过滤：
>2.加解密：
>1）注解拦截方法级控制
>2）重新认识Request.getInputStream();
>关键结论：request.getInputStream()是一次性消耗品，默认在springMVC转换器中使用并保存到对象中存储实现持久化，若在springmvc之前事先被消耗，如请求内容加解密，则需要保存内容并重新填充到新流中去，以实现重复利用的目的。
>| **维度**   | **普通简单流程**           | **RuoYi-Vue-Plus 流程**                     |
| -------- | -------------------- | ----------------------------------------- |
| **谁读流**  | 只有 Spring MVC 转换器读一次 | **Filter读**（解密）、**AOP读**（防重）、**MVC读**（业务） |
| **读几次**  | 1 次                  | **3 次及以上**                                |
| **数据形态** | 原始流直达 Controller     | 原始流在**半路**就被拦截并消耗了                        |
| **必须方案** | 不需要包装                | **必须**用 `RepeatableFilter` 变魔术，让流“复活”     |