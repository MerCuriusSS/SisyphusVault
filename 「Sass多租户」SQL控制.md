---
tags:
  - Areas/Coder/javaWeb
  - Areas/Coder/åŸºç¡€åŸç†
category: æŠ€æœ¯
status: åŠ å·¥
project: "[[02 - Projects/åå°ç®¡ç†ç³»ç»Ÿã€ŒRuoyi-Vue-Plusã€|åå°ç®¡ç†ç³»ç»Ÿã€ŒRuoyi-Vue-Plusã€]]"
application: ç§Ÿæˆ·é€»è¾‘éš”ç¦»
source:
---
>**ç¬”è®°ä¸æ˜¯ä¸ºäº†å¤è¿°ä¹¦æœ¬ï¼Œè€Œæ˜¯ä¸ºäº†**â€œå­˜æ¡£å½“ä¸‹çš„è‡ªå·±â€ã€‚å¦‚æœä½ çš„ç¬”è®°é‡Œæ²¡æœ‰ä½ çš„æ€è€ƒç—•è¿¹ã€ç—›è‹¦ç»å†å’Œé€‰æ‹©ç†ç”±**ï¼Œå®ƒå°±åªæ˜¯ä¸€ä»½æ¯«æ— ç”Ÿå‘½åŠ›çš„è¯´æ˜ä¹¦ï¼Œè‡ªç„¶æ— æ³•åœ¨æœªæ¥å”¤é†’ä½ çš„è®¤çŸ¥***


## ğŸ’¥ æ ¸å¿ƒç»“è®º
>æ ¸å¿ƒå®šä¹‰æ˜¯ä»€ä¹ˆ? æ ¸å¿ƒä»·å€¼åœ¨å“ªé‡Œ?

### ğŸŸ£ æ ¸å¿ƒå®šä¹‰ï¼šä»¥ã€Œ**ç§Ÿæˆ·**ã€ï¼ˆç»„ç»‡/æœºæ„ï¼‰ä¸ºå•ä½ï¼Œä½¿ã€Œæ•°æ®ã€æƒé™ã€é…ç½®ã€èµ„æºã€ä½¿ç”¨ç›¸äº’**ç‹¬ç«‹**ï¼Œä½†æ•´ä½“**å¤ç”¨**åŒä¸€å¥—ä»£ç é€»è¾‘å’Œéƒ¨ç½²å®ä¾‹ã€‚
### ğŸŸ£ æ ¸å¿ƒä»·å€¼ï¼šä¸€å¥—ä»£ç ï¼Œå¤šç§Ÿæˆ·ç‹¬ç«‹ä½¿ç”¨ï¼Œéš”ç¦»ä¸”å¤ç”¨ã€‚

## ğŸ”ª æˆ‘çš„è§è§£
>ä»€ä¹ˆè¦è®°å½•å®ƒï¼Ÿå®ƒè§£å†³äº†ä»€ä¹ˆæˆ‘ä»¥å‰è§£å†³ä¸äº†çš„é—®é¢˜ï¼Ÿ

### ğŸŸ£ ç—›ç‚¹ï¼š
#### 1. äººåŠ›ä¸è¶³ï¼Œç»´æŠ¤æˆæœ¬é«˜æ˜‚ï¼š
- å¤šå®¢æˆ·å¤šéƒ¨ç½²å®ä¾‹ï¼Œèµ„æºä½¿ç”¨ã€ç›‘æ§æˆæœ¬ä¸Šå‡ã€‚
-  ä¸€ä¸ªBUGä¿®å¤éœ€è¦ä¸ºæ‰€æœ‰å®¢æˆ·ç³»ç»Ÿéƒ½ä¿®å¤ä¸€æ¬¡ï¼ŒäººåŠ›ä¸è¶³ã€‚
#### 2. å®šåˆ¶åŒ–éœ€æ±‚éš¾ç®¡ç†ï¼š
- ä¸åŒç”¨æˆ·ç”¨ä¸åŒç³»ç»Ÿç‰ˆæœ¬ï¼Œæ–°åŠŸèƒ½éš¾åŒæ­¥ä¸Šçº¿ã€‚
- ä¸åŒå®šåˆ¶åŒ–éœ€æ±‚è®©ä»£ç åˆ†æ”¯æ³›æ»¥ï¼Œéš¾ç®¡ç†ã€‚

### ğŸŸ£ è§£å†³æ–¹æ¡ˆï¼š
#### 1. ç§Ÿæˆ·idé€»è¾‘éš”ç¦»ï¼Œå…±ç”¨ä¸€å¥—ä»£ç ã€ä¸€å¥—éƒ¨ç½²å®ä¾‹ï¼Œæ‰€æœ‰ç§Ÿæˆ·å…±ç”¨èµ„æºã€‚
#### 2. å…±ç”¨ä¸€å¥—ä»£ç ï¼Œç‰ˆæœ¬ç»Ÿä¸€ã€å®šåˆ¶åŒ–é€»è¾‘é€šè¿‡é…ç½®å®ç°ï¼Œç»´æŠ¤ä»£ç ç»Ÿä¸€ã€‚

## âš¡ï¸ æˆ‘çš„é‡æ„
>å®ƒçš„åº•å±‚é€»è¾‘æ˜¯ä»€ä¹ˆï¼Ÿï¼ˆå°è¯•ç”¨æœ€ç®€å•çš„ç±»æ¯”è§£é‡Šç»™å¤–è¡Œå¬ï¼‰å®ƒçš„ç»“æ„æ˜¯ä»€ä¹ˆ?

### ğŸŸ£ åº•å±‚é€»è¾‘ï¼šä¸ºå¤§éƒ¨åˆ†ä¸šåŠ¡è¡¨ã€æƒé™é…ç½®è¡¨ç»Ÿä¸€æ·»åŠ `tenant_id`å­—æ®µä½œä¸ºç§Ÿæˆ·æ ‡è¯†ï¼Œåœ¨SQLæ‰§è¡Œå‰é€šè¿‡æ‹¦æˆªå™¨è‡ªåŠ¨åœ¨WHERE å­å¥ä¸­æ·»åŠ åŸºäºç§Ÿæˆ·IDçš„è¿‡æ»¤æ¡ä»¶ã€‚

>**æ·»åŠ tenant_idåŸºå‡†ï¼šè¯¥è¡¨æ•°æ®æ˜¯å¦ã€Œå½’å±äºç‰¹å®šç§Ÿæˆ·ã€ + æ˜¯å¦ã€Œéœ€è¦åœ¨ç§Ÿæˆ·é—´éš”ç¦»ã€**

### ğŸŸ£ ç»“æ„ï¼š

#### 1.æ ¸å¿ƒç»„ä»¶
- ç§Ÿæˆ·ä¸Šä¸‹æ–‡ï¼ˆtenantContextï¼‰
- ç§Ÿæˆ·æ‹¦æˆªå™¨ï¼ˆtenantInterceptorï¼‰& ç§Ÿæˆ·å¤„ç†å™¨ï¼ˆtenantHandlerï¼‰
- ç”¨æˆ·ç™»å½•çŠ¶æ€ä¸Šä¸‹æ–‡ï¼ˆSaTokenï¼‰
- ç¼“å­˜ç»„ä»¶ï¼ˆRedisï¼‰
#### 2.ã€Œç»„ä»¶ã€æµç¨‹æ¦‚è§ˆå›¾ï¼š[ã€Œå¤šç§Ÿæˆ·éš”ç¦»ã€æµç¨‹æ¦‚è§ˆå›¾](excalidraw/ã€Œå¤šç§Ÿæˆ·éš”ç¦»ã€æµç¨‹æ¦‚è§ˆå›¾.md)
#### 3.ã€Œæ•°æ®æµè½¬ã€æµç¨‹å›¾ï¼š[ã€Œå¤šç§Ÿæˆ·éš”ç¦»ã€æ•°æ®æµè½¬å›¾](excalidraw/ã€Œå¤šç§Ÿæˆ·éš”ç¦»ã€æ•°æ®æµè½¬å›¾.md)

## ğŸš€ å®è·µåº”ç”¨ï¼š

### ğŸŸ£ æœ€å°åŒ–å®è·µï¼š
#### 1.ç§Ÿæˆ·ä¸Šä¸‹æ–‡ï¼ˆtenantContextï¼‰
```java
public class TenantContext {
    private static ThreadLocal<String> tenantId = new ThreadLocal<>();
    private static ThreadLocal<Boolean> ignore = new ThreadLocal<>();

    public static void setTenantId(String id) {
        tenantId.set(id);
    }

    public static String getTenantId() {
        return tenantId.get();
    }

    public static void setIgnore(Boolean flag) {
        ignore.set(flag);
    }

    public static Boolean isIgnore() {
        return Boolean.TRUE.equals(ignore.get());
    }

    public static void clear() {
        tenantId.remove();
        ignore.remove();
    }
}
```

#### 2. ç§Ÿæˆ·æ‹¦æˆªå™¨ï¼ˆtenantInterceptorï¼‰
```java
@Intercepts({@Signature(type = Executor.class, method = "query", ...)})
public class TenantInterceptor implements Interceptor {

    private List<String> excludeTables = Arrays.asList("sys_tenant");

    @Override
    public Object intercept(Invocation invocation) throws Throwable {
        // 1. è·å–åŸå§‹SQL
        String originalSql = boundSql.getSql();

        // 2. æ£€æŸ¥æ˜¯å¦éœ€è¦ç§Ÿæˆ·éš”ç¦»
        if (TenantContext.isIgnore()) {
            return invocation.proceed(); // å¿½ç•¥æ¨¡å¼
        }

        String tenantId = TenantContext.getTenantId();
        if (tenantId == null) {
            return invocation.proceed(); // æ²¡æœ‰ç§Ÿæˆ·ID
        }

        // 3. æ£€æŸ¥è¡¨æ˜¯å¦åœ¨æ’é™¤åˆ—è¡¨ä¸­
        if (isExcludeTable(originalSql)) {
            return invocation.proceed();
        }

        // 4. æ‹¼æ¥ç§Ÿæˆ·æ¡ä»¶
        String newSql = appendTenantCondition(originalSql, tenantId);

        // 5. æ‰§è¡Œæ–°SQL
        return executeNewSql(newSql);
    }

    private String appendTenantCondition(String sql, String tenantId) {
        if (sql.toUpperCase().contains("WHERE")) {
            return sql + " AND tenant_id = '" + tenantId + "'";
        } else {
            return sql + " WHERE tenant_id = '" + tenantId + "'";
        }
    }
}
```

### ğŸŸ£ ruoyi ç§Ÿæˆ·åŸå®ç°
>ç‰¹ç‚¹ï¼šMyBatis-Plus + Rediséš”ç¦» + ç¼“å­˜éš”ç¦»

#### 1.ç§Ÿæˆ·é…ç½®
- è‡ªåŠ¨è£…é…å¼€å¯ã€Œç§Ÿæˆ·è¿‡æ»¤ã€åŠŸèƒ½
- ç§Ÿæˆ·æ‹¦æˆªå™¨&å¤„ç†å™¨
- Rediså…¨å±€keyæ·»åŠ ã€Œç§Ÿæˆ·IDå‰ç¼€ã€é…ç½®
```java
@EnableConfigurationProperties(TenantProperties.class)
@AutoConfiguration(after = {RedisConfig.class})
@ConditionalOnProperty(value = "tenant.enable", havingValue = "true")
public class TenantConfig {

    /**
     * å¤šç§Ÿæˆ·æ’ä»¶
     */
    @Bean
    public TenantLineInnerInterceptor tenantLineInnerInterceptor(
            TenantProperties tenantProperties) {
        return new TenantLineInnerInterceptor(
            new PlusTenantLineHandler(tenantProperties)
        );
    }

    /**
     * å¤šç§Ÿæˆ· Redis Key å‰ç¼€å¤„ç†å™¨
     */
    @Bean
    public RedissonAutoConfigurationCustomizer tenantRedissonCustomizer(
            RedissonProperties redissonProperties) {
        return config -> {
            TenantKeyPrefixHandler nameMapper =
                new TenantKeyPrefixHandler(redissonProperties.getKeyPrefix());

            SingleServerConfig singleServerConfig = config.useSingleServer();
            if (ObjectUtil.isNotNull(singleServerConfig)) {
                singleServerConfig.setNameMapper(nameMapper);
            }

            ClusterServersConfig clusterServersConfig = config.useClusterServers();
            if (ObjectUtil.isNotNull(clusterServersConfig)) {
                clusterServersConfig.setNameMapper(nameMapper);
            }
        };
    }

    /**
     * å¤šç§Ÿæˆ·ç¼“å­˜ç®¡ç†å™¨
     */
    @Primary
    @Bean
    public CacheManager tenantCacheManager() {
        return new TenantSpringCacheManager();
    }

    /**
     * å¤šç§Ÿæˆ·é‰´æƒ DAO å®ç°
     */
    @Primary
    @Bean
    public SaTokenDao tenantSaTokenDao() {
        return new TenantSaTokenDao();
    }
}
```

#### 2.Redisç¼“å­˜å…¨å±€æ·»åŠ ã€Œç§Ÿæˆ·IDå‰ç¼€ã€é€»è¾‘
```java
public class TenantSpringCacheManager extends RedisCacheManager {

    public TenantSpringCacheManager(RedisCacheWriter cacheWriter,
                                    RedisCacheConfiguration defaultCacheConfiguration) {
        super(cacheWriter, defaultCacheConfiguration);
    }

    @Override
    public Cache getCache(String name) {
        // å…¨å±€ç¼“å­˜ï¼Œä¸æ·»åŠ ç§Ÿæˆ·å‰ç¼€
        if (StringUtils.contains(name, GlobalConstants.GLOBAL_REDIS_KEY)) {
            return super.getCache(name);
        }

        // å¿½ç•¥ç§Ÿæˆ·æ¨¡å¼ï¼Œä¸æ·»åŠ ç§Ÿæˆ·å‰ç¼€
        if (TenantHelper.isIgnore()) {
            return super.getCache(name);
        }

        // è·å–ç§Ÿæˆ·ID
        String tenantId = TenantHelper.getTenantId();
        if (StringUtils.isBlank(tenantId)) {
            return super.getCache(name);
        }

        // æ·»åŠ ç§Ÿæˆ·å‰ç¼€
        return super.getCache(tenantId + ":" + name);
    }
}
```

#### 3.SaToken ä¸­ã€Œç”¨æˆ·ç™»å½•çŠ¶æ€KEYã€çš„ã€Œglobalå‰ç¼€ã€å…¨å±€ä¿®æ”¹
```java
public class TenantSaTokenDao extends SaTokenDaoRedis {

    /**
     * é‡å†™æ‰€æœ‰Keyæ“ä½œæ–¹æ³•ï¼Œæ·»åŠ å…¨å±€å‰ç¼€
     */

    @Override
    public String get(String key) {
        return super.get(GlobalConstants.GLOBAL_REDIS_KEY + key);
    }

    @Override
    public void set(String key, String value, long timeout) {
        super.set(GlobalConstants.GLOBAL_REDIS_KEY + key, value, timeout);
    }

    @Override
    public void delete(String key) {
        super.delete(GlobalConstants.GLOBAL_REDIS_KEY + key);
    }

    // ... å…¶ä»–æ–¹æ³•ç±»ä¼¼
}
```

#### 4.TenantHelperç§Ÿæˆ·ä¸Šä¸‹æ–‡é€»è¾‘ï¼š

##### 1.è·å–å½“å‰ç§Ÿæˆ·ID
```java
public static String getTenantId() {
    if (!isEnable()) {
        return null;
    }

    // ä¼˜å…ˆè·å–åŠ¨æ€ç§Ÿæˆ·ID
    String tenantId = TenantHelper.getDynamic();
    if (StringUtils.isBlank(tenantId)) {
        // å…¶æ¬¡ä»ç™»å½•ç”¨æˆ·è·å–
        tenantId = LoginHelper.getTenantId();
    }

    return tenantId;
}
```

`è·å–ä¼˜å…ˆçº§ï¼šåŠ¨æ€ç§Ÿæˆ·ï¼ˆThreadLocal/Redisï¼‰ > ç™»å½•ç”¨æˆ·ç§Ÿæˆ·ID`
##### 2. å¿½ç•¥ç§Ÿæˆ·éš”ç¦»
```java
/**
 * å¼€å¯å¿½ç•¥ç§Ÿæˆ·ï¼ˆå¼€å…³ï¼‰
 */
private static final ThreadLocal<Boolean> IGNORE = new ThreadLocal<>();

public static void enableIgnore() {
    IGNORE.set(true);
}

public static void disableIgnore() {
    IGNORE.remove();
}

public static boolean isIgnore() {
    return Convert.toBool(IGNORE.get(), false);
}

/**
 * å¿½ç•¥ç§Ÿæˆ·éš”ç¦»æ‰§è¡Œ
 */
public static void ignore(Runnable handle) {
    enableIgnore();
    try {
        handle.run();
    } finally {
        disableIgnore();
    }
}

public static <T> T ignore(Supplier<T> handle) {
    enableIgnore();
    try {
        return handle.get();
    } finally {
        disableIgnore();
    }
}
```

##### 3.åŠ¨æ€åˆ‡æ¢ç§Ÿæˆ·
```java
/**
 * ä¸´æ—¶åŠ¨æ€ç§Ÿæˆ·ï¼ˆThreadLocalï¼‰
 */
private static final ThreadLocal<String> TEMP_DYNAMIC_TENANT = new ThreadLocal<>();

/**
 * åŠ¨æ€ç§Ÿæˆ·Keyå‰ç¼€ï¼ˆRedisï¼‰
 */
private static final String DYNAMIC_TENANT_KEY = "global:dynamicTenant";

/**
 * è®¾ç½®åŠ¨æ€ç§Ÿæˆ·
 *
 * @param tenantId ç§Ÿæˆ·ID
 * @param global   æ˜¯å¦å…¨å±€ï¼ˆtrue-å­˜å‚¨åˆ°Redisï¼Œfalse-ä»…ThreadLocalï¼‰
 */
public static void setDynamic(String tenantId, boolean global) {
    if (!isEnable()) {
        return;
    }

    // æœªç™»å½•æˆ–éå…¨å±€æ¨¡å¼ï¼Œä½¿ç”¨ThreadLocal
    if (!LoginHelper.isLogin() || !global) {
        TEMP_DYNAMIC_TENANT.set(tenantId);
        return;
    }

    // å…¨å±€æ¨¡å¼ï¼Œå­˜å‚¨åˆ°Redis
    String cacheKey = DYNAMIC_TENANT_KEY + ":" + LoginHelper.getUserId();
    RedisUtils.setCacheObject(cacheKey, tenantId);

    // åŒæ—¶å­˜å‚¨åˆ°SaTokenä¼šè¯ä¸­ï¼ˆé¿å…é‡å¤æŸ¥è¯¢Redisï¼‰
    SaHolder.getStorage().set(cacheKey, tenantId);
}

/**
 * è·å–åŠ¨æ€ç§Ÿæˆ·
 */
public static String getDynamic() {
    if (!isEnable()) {
        return null;
    }

    // 1. ä¼˜å…ˆä»ThreadLocalè·å–
    String tenantId = TEMP_DYNAMIC_TENANT.get();
    if (StringUtils.isNotBlank(tenantId)) {
        return tenantId;
    }

    // 2. æœªç™»å½•ï¼Œè¿”å›null
    if (!LoginHelper.isLogin()) {
        return null;
    }

    // 3. ä»SaTokenä¼šè¯è·å–ï¼ˆè¯·æ±‚çº§ç¼“å­˜ï¼‰
    String cacheKey = DYNAMIC_TENANT_KEY + ":" + LoginHelper.getUserId();
    tenantId = (String) SaHolder.getStorage().get(cacheKey);
    if (StringUtils.isNotBlank(tenantId)) {
        return tenantId;
    }

    // 4. ä»Redisè·å–ï¼ˆæŒä¹…åŒ–å­˜å‚¨ï¼‰
    tenantId = RedisUtils.getCacheObject(cacheKey);
    if (StringUtils.isNotBlank(tenantId)) {
        // ç¼“å­˜åˆ°SaTokenä¼šè¯
        SaHolder.getStorage().set(cacheKey, tenantId);
        return tenantId;
    }

    return null;
}

/**
 * æ¸…é™¤åŠ¨æ€ç§Ÿæˆ·
 */
public static void clearDynamic() {
    if (!isEnable()) {
        return;
    }

    // æ¸…é™¤ThreadLocal
    TEMP_DYNAMIC_TENANT.remove();

    if (!LoginHelper.isLogin()) {
        return;
    }

    // æ¸…é™¤Rediså’ŒSaTokenä¼šè¯
    String cacheKey = DYNAMIC_TENANT_KEY + ":" + LoginHelper.getUserId();
    RedisUtils.deleteObject(cacheKey);
    SaHolder.getStorage().delete(cacheKey);
}

/**
 * åœ¨åŠ¨æ€ç§Ÿæˆ·ä¸­æ‰§è¡Œ
 */
public static void dynamic(String tenantId, Runnable handle) {
    setDynamic(tenantId);
    try {
        handle.run();
    } finally {
        clearDynamic();
    }
}

public static <T> T dynamic(String tenantId, Supplier<T> handle) {
    setDynamic(tenantId);
    try {
        return handle.get();
    } finally {
        clearDynamic();
    }
}
```

`åŠ¨æ€ç§Ÿæˆ·å­˜å‚¨å±‚æ¬¡ï¼šThreadLocalï¼ˆä¸´æ—¶ï¼‰ > SaTokenä¼šè¯ï¼ˆè¯·æ±‚çº§ï¼‰ > Redisï¼ˆæŒä¹…åŒ–ï¼‰`
#### 5.æ‹¦æˆªå¤„ç†å™¨é€»è¾‘ï¼š
```java
@Slf4j
@AllArgsConstructor
public class PlusTenantLineHandler implements TenantLineHandler {

    private final TenantProperties tenantProperties;

    /**
     * è·å–ç§Ÿæˆ·ID
     * è¿”å›Expressionå¯¹è±¡ï¼ŒMyBatis-Plusä¼šè‡ªåŠ¨å°†å…¶æ·»åŠ åˆ°SQLä¸­
     */
    @Override
    public Expression getTenantId() {
        String tenantId = TenantHelper.getTenantId();
        if (StringUtils.isBlank(tenantId)) {
            log.error("æ— æ³•è·å–æœ‰æ•ˆçš„ç§Ÿæˆ·id -> Null");
            return new NullValue();
        }
        // ï¿½ï¿½å›ç§Ÿæˆ·IDçš„å­—ç¬¦ä¸²å€¼
        return new StringValue(tenantId);
    }

    /**
     * åˆ¤æ–­è¡¨æ˜¯å¦éœ€è¦å¿½ç•¥ç§Ÿæˆ·éš”ç¦»
     *
     * @param tableName è¡¨å
     * @return true-å¿½ç•¥ï¼Œfalse-ä¸å¿½ç•¥
     */
    @Override
    public boolean ignoreTable(String tableName) {
        String tenantId = TenantHelper.getTenantId();

        // åˆ¤æ–­æ˜¯å¦æœ‰ç§Ÿæˆ·
        if (StringUtils.isNotBlank(tenantId)) {
            // ä»é…ç½®æ–‡ä»¶è¯»å–æ’é™¤è¡¨åˆ—è¡¨
            List<String> excludes = tenantProperties.getExcludes();

            // å†…ç½®æ’é™¤è¡¨ï¼ˆä»£ç ç”Ÿæˆå™¨ç›¸å…³ï¼‰
            List<String> tables = ListUtil.toList(
                "gen_table",
                "gen_table_column"
            );
            tables.addAll(excludes);

            // åˆ¤æ–­å½“å‰è¡¨æ˜¯å¦åœ¨æ’é™¤åˆ—è¡¨ä¸­
            return StringUtils.equalsAnyIgnoreCase(tableName,
                tables.toArray(new String[0]));
        }

        // æ²¡æœ‰ç§Ÿæˆ·IDï¼Œå¿½ç•¥æ‰€æœ‰è¡¨
        return true;
    }
}
```

#### 6.è°ƒç”¨æ–¹å¼
##### 1.å¿½ç•¥ç§Ÿæˆ·&åŠ¨æ€åˆ‡æ¢ç§Ÿæˆ·ï¼ˆå®šæ—¶ä»»åŠ¡ï¼‰
```java
@Scheduled(cron = "0 0 2 * * ?")
public void dailyTask() {
    // æŸ¥è¯¢æ‰€æœ‰å¯ç”¨çš„ç§Ÿæˆ·
    List<SysTenant> tenants = TenantHelper.ignore(() -> {
        return tenantMapper.selectList(
            new LambdaQueryWrapper<SysTenant>()
                .eq(SysTenant::getStatus, "0")
        );
    });

    // éå†æ¯ä¸ªç§Ÿæˆ·æ‰§è¡Œä»»åŠ¡
    for (SysTenant tenant : tenants) {
        TenantHelper.dynamic(tenant.getTenantId(), () -> {
            // åœ¨å½“å‰ç§Ÿæˆ·ä¸‹æ‰§è¡Œä»»åŠ¡
            log.info("æ‰§è¡Œç§Ÿæˆ·{}çš„å®šæ—¶ä»»åŠ¡", tenant.getTenantName());
            // ... ä¸šåŠ¡é€»è¾‘
        });
    }
}
```

### ğŸŸ£ ã€Œæœ€å°å®è·µã€ä¸ã€Œruoyiå®ç°ã€æ¯”å¯¹


| ç‰¹æ€§   | æœ€å°åŒ–å®è·µ            | ruoyiå®ç° | æ ¸å¿ƒé€»è¾‘                                 |     |
| ---- | ---------------- | ------- | ------------------------------------ | --- |
| ç”¨æˆ·ä½¿ç”¨ | ä¾èµ–ç™»å½•ç”¨æˆ·ï¼Œåˆ‡æ¢ç”¨æˆ·ä¼šç™»å½•å¤±æ•ˆ | ä¸ä¾èµ–ç™»å½•æ€  | 1ï¼‰Redisä¸“é—¨ä¿ç•™åŠ¨æ€ç§Ÿæˆ·ID<br>2ï¼‰Rediså…¨å±€å­˜Token |     |
|      |                  |         |                                      |     |


## â›ª åœºæ™¯è®¾æƒ³
- **åœºæ™¯ A**ï¼šåœ¨å¤„ç† [XXX] ä»£ç é€»è¾‘æ—¶å¯ä»¥æ›¿ä»£åŸæœ‰çš„ [YYY] æ–¹æ³•ã€‚
- **åœºæ™¯ B**ï¼šåœ¨è¿›è¡Œ [ZZZ] å†³ç­–æ—¶ï¼Œç”¨æ¥è§„é¿é€»è¾‘è°¬è¯¯ã€‚