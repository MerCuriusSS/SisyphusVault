---

excalidraw-plugin: parsed
tags: [excalidraw]

---
==⚠  Switch to EXCALIDRAW VIEW in the MORE OPTIONS menu of this document. ⚠== You can decompress Drawing data with the command palette: 'Decompress current Excalidraw file'. For more info check in plugin settings under 'Saving'


# Excalidraw Data

## Text Elements
mapper ^uWj1dD1D

DB ^4pGDRwLJ

1. 用户发起请求 ^4vKQITQd

3. 多租户拦截器拦截原生SQL
TenantInterceptor.intercept() ^4ZjCHdzr

2.mapper执行SQL查询 ^JByvBGnZ

TenantInterceptor ^PjZsYG8L

TenantContext
(ThreadLocal) ^7FiO24ZE

4.检查是否忽略租户隔离
TenantContext.isIgnore() ^8yDPMEZi

5.获取当前租户ID
TenantContext.getTenantId() ^qKbbTMZo

6.拼接租户条件到SQL
WHERE tenant_id = '000001' ^WODOeqdf

7.执行修改后的SQL ^arisoSD4

%%
## Drawing
```compressed-json
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=
```
%%