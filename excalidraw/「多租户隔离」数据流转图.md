---

excalidraw-plugin: parsed
tags: [excalidraw]

---
==⚠  Switch to EXCALIDRAW VIEW in the MORE OPTIONS menu of this document. ⚠== You can decompress Drawing data with the command palette: 'Decompress current Excalidraw file'. For more info check in plugin settings under 'Saving'


# Excalidraw Data

## Text Elements
mapper ^uWj1dD1D

DB ^4pGDRwLJ

1. 用户发起请求 ^4vKQITQd

3. 多租户拦截器拦截原生SQL
TenantInterceptor.intercept() ^4ZjCHdzr

2.mapper执行SQL查询 ^JByvBGnZ

TenantInterceptor ^PjZsYG8L

TenantContext
(ThreadLocal) ^7FiO24ZE

4.检查是否忽略租户隔离
TenantContext.isIgnore() ^8yDPMEZi

5.获取当前租户ID
TenantContext.getTenantId() ^qKbbTMZo

6.拼接租户条件到SQL ^WODOeqdf

%%
## Drawing
```compressed-json
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
```
%%