---

excalidraw-plugin: parsed
tags: [excalidraw]

---
==⚠  Switch to EXCALIDRAW VIEW in the MORE OPTIONS menu of this document. ⚠== You can decompress Drawing data with the command palette: 'Decompress current Excalidraw file'. For more info check in plugin settings under 'Saving'


# Excalidraw Data

## Text Elements
tenantHelper ^vSGpxwmH

SaToken ^e2nyP11s

拦截器(TenantLineInnerInterceptor)
&
处理器(PlusTenantLineHandler) ^6Mxzroqe

Redis ^ZtKgC4yx

1）tenantHelper：管理租户上下文
2）SaToken：管理用户登录状态上下文
3）Redis：缓存业务逻辑信息、动态租户ID、登录用户状态
4）拦截器及处理器：拦截原始SQL，追加Where 租户条件 ^vL0AJchf

准生产级扩充组件 ^RnIVlyp6

最小化实践组件 ^YYq7lyHA

%%
## Drawing
```compressed-json
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=
```
%%