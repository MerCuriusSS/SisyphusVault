---

excalidraw-plugin: parsed
tags: [excalidraw]

---
==⚠  Switch to EXCALIDRAW VIEW in the MORE OPTIONS menu of this document. ⚠== You can decompress Drawing data with the command palette: 'Decompress current Excalidraw file'. For more info check in plugin settings under 'Saving'


# Excalidraw Data

## Text Elements
tenantHelper ^vSGpxwmH

SaToken ^e2nyP11s

拦截器(TenantLineInnerInterceptor)
&
处理器(PlusTenantLineHandler) ^6Mxzroqe

Redis ^ZtKgC4yx

1）tenantHelper：管理租户上下文
2）SaToken：管理用户登录状态上下文
3）Redis：缓存业务逻辑信息、动态租户ID、登录用户状态
4）拦截器及处理器：拦截原始SQL，追加Where 租户条件 ^vL0AJchf

%%
## Drawing
```compressed-json
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
```
%%